<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bot Mensagem</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="rta-form.css" />
    <style>
      /* Sidebar collapse */
      body.sidebar-collapsed #sidebar {
        width: 64px;
      }
      body.sidebar-collapsed #sidebar h2,
      body.sidebar-collapsed #sidebar .service-btn span {
        display: none;
      }
      body.sidebar-collapsed #sidebar .service-btn {
        justify-content: center;
        padding: 12px;
      }
      body.sidebar-collapsed #sidebarToggle {
        display: none;
      }
      body.sidebar-collapsed #sidebarOpenToggle {
        display: block !important;
      }

      /* Bot√µes de servi√ßo */
      .service-btn {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        border-radius: 8px;
        background: rgba(15, 23, 42, 0.5);
        color: rgb(148, 163, 184);
        border: 1px solid rgba(51, 65, 85, 0.5);
        cursor: pointer;
        transition: all 0.2s;
        font-size: 14px;
        font-weight: 500;
        width: 100%;
        text-align: left;
        pointer-events: auto;
        position: relative;
        z-index: 10;
      }
      .service-btn:hover {
        background: rgba(30, 41, 59, 0.7);
        color: rgb(226, 232, 240);
        border-color: rgba(71, 85, 105, 0.8);
      }
      .service-btn.active {
        background: rgba(59, 130, 246, 0.2);
        color: rgb(96, 165, 250);
        border-color: rgba(59, 130, 246, 0.5);
      }
      .service-btn-icon {
        width: 20px;
        height: 20px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        pointer-events: none;
      }
      .service-btn svg {
        width: 20px;
        height: 20px;
        pointer-events: none;
      }
      .service-btn span {
        pointer-events: none;
      }
      .service-btn-emoji {
        font-size: 18px;
      }

      /* Views */
      .service-view {
        display: none;
      }
      .service-view.active-view {
        display: block;
      }

      /* Sele√ß√£o de m√≥dulos */
      .module-card {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        align-items: flex-start;
        width: 100%;
        border-radius: 1rem;
        border: 1px solid rgba(51, 65, 85, 0.5);
        background: rgba(15, 23, 42, 0.65);
        padding: 1.5rem;
        transition: transform 0.2s ease, border-color 0.2s ease, background 0.2s ease;
        text-align: left;
        cursor: pointer;
      }

      .module-card:hover {
        transform: translateY(-4px);
        border-color: rgba(59, 130, 246, 0.5);
        background: rgba(30, 41, 59, 0.7);
      }

      .module-card:focus-visible {
        outline: none;
        border-color: rgba(59, 130, 246, 0.8);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
      }

      .module-card-icon-wrapper {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 3rem;
        height: 3rem;
        border-radius: 0.75rem;
        background: rgba(59, 130, 246, 0.12);
        color: rgba(96, 165, 250, 1);
      }

      .module-card-icon {
        width: 1.75rem;
        height: 1.75rem;
        font-size: 1.5rem;
      }

      .module-card-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: #e2e8f0;
      }

      .module-card-description {
        font-size: 0.875rem;
        color: rgba(148, 163, 184, 0.9);
      }
    </style>
  </head>
  <body class="antialiased">
    <div class="min-h-screen flex">
  <!-- Sidebar √† esquerda -->
  <aside id="sidebar" class="w-64 bg-slate-900/50 border-r border-slate-800 flex flex-col p-4 gap-4 hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-lg font-semibold text-white">Servi√ßos</h2>
          <button id="sidebarToggle" class="text-slate-400 hover:text-white text-2xl leading-none" title="Minimizar sidebar">‚Äπ</button>
        </div>
        <nav id="servicesNav" class="flex flex-col gap-2">
          <!-- Itens de servi√ßos s√£o renderizados via renderer.js -->
        </nav>
      </aside>

      <!-- Conte√∫do principal -->
      <div class="flex-1 flex flex-col">
  <header class="bg-slate-900/30 border-b border-slate-800 px-6 py-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <button id="sidebarOpenToggle" class="hidden text-slate-400 hover:text-white text-2xl leading-none" title="Mostrar sidebar">‚ò∞</button>
              <h1 class="text-3xl font-semibold text-white">Central de disparos WhatsApp</h1>
            </div>
            <p class="text-sm text-slate-400">Use os bot√µes de servi√ßos para trocar de m√≥dulo.</p>
          </div>
        </header>

  <main class="flex-1 overflow-auto px-6 py-8">
          <div class="mx-auto max-w-7xl">

          <section id="selectionView" class="flex flex-col gap-6" style="display: flex;">
          <div class="card">
            <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
              <div class="space-y-2">
                <h2 class="text-2xl font-semibold text-white">Selecione quem vai disparar</h2>
              </div>
            </div>
          </div>

          <div id="profilesContainer" class="grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
            <!-- Os cards dos perfis ser√£o inseridos aqui dinamicamente -->
          </div>
        </section>

          <section id="moduleSelectionView" class="flex flex-col gap-6" style="display: none;">
          <div class="card space-y-2">
            <h2 class="text-2xl font-semibold text-white">Escolha o m√≥dulo</h2>
            <p class="text-sm text-slate-400">Selecione qual m√≥dulo deseja utilizar com o operador escolhido.</p>
          </div>
          <div id="moduleCards" class="grid gap-5 sm:grid-cols-2 xl:grid-cols-3"></div>
        </section>

          <section id="controlView" class="flex-col gap-6" style="display: none;">
          <div class="card flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
            <div>
              <button id="backToProfiles" class="btn-secondary mb-4 md:mb-2"><span aria-hidden="true">‚Üê</span> Trocar operador</button>
              <div class="space-y-1">
                <p class="text-sm uppercase tracking-wide text-slate-400">Operador selecionado</p>
                <h2 id="activeProfileName" class="text-2xl font-semibold text-white">‚Äî</h2>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <button id="startButton" class="btn-primary">Iniciar envios</button>
              <button id="stopButton" class="btn-secondary" disabled>Parar envios</button>
            </div>
          </div>

          <div class="grid gap-6 lg:grid-cols-[minmax(0,320px)_1fr]">
            <article class="card space-y-4">
              <header class="space-y-1">
                <p class="text-sm uppercase tracking-wide text-slate-400">Mensagens salvas</p>
                <h3 class="text-lg font-semibold text-white">Gerenciar mensagens</h3>
              </header>
              
              <div id="messagesList" class="space-y-2 max-h-96 overflow-y-auto">
                <!-- Lista de mensagens ser√° inserida aqui -->
              </div>
              
              <button id="addMessageBtn" class="btn-secondary w-full">
                <span aria-hidden="true">+</span> Adicionar mensagem
              </button>
              
              <div class="pt-4 border-t border-slate-700">
                <p class="text-sm uppercase tracking-wide text-slate-400 mb-2">Configura√ß√µes</p>
                <div class="space-y-2">
                  <label for="sendLimitInput" class="block text-sm font-medium text-slate-300">
                    N√∫mero de grupos para enviar
                  </label>
                  <input 
                    type="number" 
                    id="sendLimitInput" 
                    min="1" 
                    max="1000" 
                    class="w-full rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 focus:outline-none focus:ring-2 focus:ring-brand-500"
                    placeholder="200"
                  />
                  <button id="saveSendLimitBtn" class="btn-secondary w-full text-sm">
                    üíæ Salvar configura√ß√£o
                  </button>
                </div>
              </div>
              
              <div class="pt-4 border-t border-slate-700">
                <p class="text-sm uppercase tracking-wide text-slate-400 mb-2">Mensagem selecionada</p>
                <pre id="activeProfileMessage" class="max-h-48 overflow-y-auto whitespace-pre-wrap rounded-xl bg-slate-950/60 p-4 text-sm text-slate-200"></pre>
              </div>
            </article>

            <section class="card space-y-4">
              <header class="flex items-center justify-between">
                <div>
                  <p class="text-sm uppercase tracking-wide text-slate-400">Status em tempo real</p>
                  <h3 class="text-lg font-semibold text-white">Execu√ß√£o atual</h3>
                </div>
                <span id="statusBadge" class="tag bg-emerald-500/10 text-emerald-300">Aguardando</span>
              </header>
              <p id="statusText" class="text-sm text-slate-300">Escolha um operador e clique em iniciar para come√ßar.</p>
              <div class="space-y-3">
                <h4 class="text-sm font-semibold text-slate-200">Logs recentes</h4>
                <div id="logContainer" class="max-h-72 overflow-y-auto rounded-xl bg-slate-950/60 p-4 text-xs text-slate-300"></div>
              </div>
            </section>
          </div>
          </section>

          <!-- Conte√∫do do RTA -->
          <section id="rtaView" class="flex-col gap-6" style="display: none;">
            <div class="card space-y-4">
              <header class="space-y-1">
                <p class="text-sm uppercase tracking-wide text-slate-400">RTA Autom√°tico</p>
                <h3 class="text-lg font-semibold text-white">Gerar RTA</h3>
              </header>
                <form id="rtaForm" class="rta-form">
                  <section class="rta-section" aria-labelledby="rta-insurance">
                    <div class="rta-section-header">
                      <div class="rta-section-icon" aria-hidden="true">üõ°Ô∏è</div>
                      <div>
                        <h4 class="rta-section-title" id="rta-insurance">Seguradora</h4>
                        <p class="rta-section-description">Escolha a seguradora respons√°vel antes de preencher os demais dados.</p>
                      </div>
                    </div>
                    <div class="rta-grid rta-grid-auto">
                      <div class="input-group">
                        <label for="insurance_company">Seguradora</label>
                        <select id="insurance_company" name="insurance_company" class="input-control">
                          <option value="">Selecione</option>
                          <option value="allstate">Allstate</option>
                          <option value="progressive">Progressive</option>
                          <option value="geico">Geico</option>
                          <option value="liberty">Liberty</option>
                        </select>
                      </div>
                    </div>
                  </section>
                  <section class="rta-section" aria-labelledby="rta-vehicle">
                    <div class="rta-section-header">
                      <div class="rta-section-icon" aria-hidden="true">ÔøΩ</div>
                      <div>
                        <h4 class="rta-section-title" id="rta-vehicle">Ve√≠culo</h4>
                        <p class="rta-section-description">Detalhes do ve√≠culo exatamente na mesma sequ√™ncia do sistema legado.</p>
                      </div>
                    </div>
                    <div class="rta-grid rta-grid-compact">
                      <div class="input-group">
                        <label for="vin">VIN</label>
                        <input id="vin" name="vin" maxlength="17" class="input-control" placeholder="17 caracteres" />
                        <span class="input-hint">Use letras mai√∫sculas e n√∫meros, sem espa√ßos.</span>
                      </div>
                      <div class="input-group">
                        <label for="body_style">Body Style</label>
                        <input id="body_style" name="body_style" class="input-control" placeholder="Ex: Sedan" />
                      </div>
                      <div class="input-group">
                        <label for="year">Ano</label>
                        <input id="year" name="year" type="number" class="input-control" placeholder="Ex: 2024" />
                      </div>
                      <div class="input-group">
                        <label for="make">Marca</label>
                        <input id="make" name="make" class="input-control" placeholder="Ex: Toyota" />
                      </div>
                      <div class="input-group">
                        <label for="model">Modelo</label>
                        <input id="model" name="model" class="input-control" placeholder="Ex: Corolla" />
                      </div>
                      <div class="input-group">
                        <label for="color">Cor</label>
                        <select id="color" name="color" class="input-control">
                          <option value="">Selecione</option>
                          <option>Black</option>
                          <option>White</option>
                          <option>Brown</option>
                          <option>Blue</option>
                          <option>Yellow</option>
                          <option>Gray</option>
                          <option>Purple</option>
                          <option>Green</option>
                          <option>Orange</option>
                          <option>Red</option>
                          <option>Silver</option>
                          <option>Gold</option>
                        </select>
                      </div>
                      <div class="input-group">
                        <label for="cylinders">Cilindros</label>
                        <input id="cylinders" name="cylinders" type="number" class="input-control" placeholder="Ex: 4" />
                      </div>
                      <div class="input-group">
                        <label for="passengers">Passageiros</label>
                        <input id="passengers" name="passengers" type="number" class="input-control" placeholder="Ex: 5" />
                      </div>
                      <div class="input-group">
                        <label for="doors">Portas</label>
                        <input id="doors" name="doors" type="number" class="input-control" placeholder="Ex: 4" />
                      </div>
                      <div class="input-group">
                        <label for="odometer">Od√¥metro em milhas</label>
                        <input id="odometer" name="odometer" type="number" step="0.1" class="input-control" placeholder="Ex: 25000" />
                      </div>
                    </div>
                  </section>

                  <section class="rta-section" aria-labelledby="rta-title">
                    <div class="rta-section-header">
                      <div class="rta-section-icon" aria-hidden="true">ÔøΩ</div>
                      <div>
                        <h4 class="rta-section-title" id="rta-title">T√≠tulo e Seguro</h4>
                        <p class="rta-section-description">Agrupe os dados do t√≠tulo anterior e das datas do seguro antes de gerar o PDF.</p>
                      </div>
                    </div>
                    <fieldset class="rta-fieldset" aria-describedby="title-status-hint">
                      <legend>Status do ve√≠culo em rela√ß√£o ao t√≠tulo</legend>
                      <p id="title-status-hint" class="input-hint">Escolha se o ve√≠culo est√° financiado ou quitado para ajustar os campos necess√°rios.</p>
                      <div class="rta-radio-group">
                        <label class="rta-radio-option">
                          <input type="radio" name="title_status" value="financed" />
                          <span>Financiado</span>
                        </label>
                        <label class="rta-radio-option">
                          <input type="radio" name="title_status" value="paid_off" checked />
                          <span>Quitado</span>
                        </label>
                      </div>
                    </fieldset>
                    <div class="rta-subsections">
                      <div class="rta-subsection" id="previousTitleSection">
                        <h5 class="rta-subsection-title">T√≠tulo anterior</h5>
                        <div class="rta-grid rta-grid-auto">
                          <div class="input-group">
                            <label for="previous_title_number">N√∫mero</label>
                            <input id="previous_title_number" name="previous_title_number" class="input-control" placeholder="Ex: CN539192" />
                          </div>
                          <div class="input-group">
                            <label for="previous_title_state">Estado</label>
                            <input id="previous_title_state" name="previous_title_state" maxlength="2" class="input-control" placeholder="Ex: MA" />
                          </div>
                          <div class="input-group">
                            <label for="previous_title_country">Pa√≠s</label>
                            <input id="previous_title_country" name="previous_title_country" class="input-control" placeholder="Ex: USA" />
                          </div>
                        </div>
                      </div>
                      <div class="rta-subsection">
                        <h5 class="rta-subsection-title">Seguro e datas</h5>
                        <div class="rta-grid rta-grid-auto">
                          <div class="input-group">
                            <label for="purchase_date">Data de compra</label>
                            <input id="purchase_date" name="purchase_date" type="date" class="input-control" />
                          </div>
                          <div class="input-group">
                            <label for="insurance_effective_date">In√≠cio do seguro</label>
                            <input id="insurance_effective_date" name="insurance_effective_date" type="date" class="input-control" />
                          </div>
                          <div class="input-group">
                            <label for="insurance_policy_change_date">Altera√ß√£o da ap√≥lice</label>
                            <input id="insurance_policy_change_date" name="insurance_policy_change_date" type="date" class="input-control" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </section>

                  <section class="rta-section" aria-labelledby="rta-client">
                    <div class="rta-section-header">
                      <div class="rta-section-icon" aria-hidden="true">ÔøΩ</div>
                      <div>
                        <h4 class="rta-section-title" id="rta-client">Cliente</h4>
                        <p class="rta-section-description">Preencha o bloco do cliente seguindo a ordem do RTA web original.</p>
                      </div>
                    </div>
                    <div class="rta-grid rta-grid-wide">
                      <div class="input-group">
                        <label for="owner_name">Nome completo</label>
                        <input id="owner_name" name="owner_name" class="input-control" placeholder="Sobrenome, Nome, Nome do meio" />
                      </div>
                      <div class="input-group">
                        <label for="owner_dob">Nascimento</label>
                        <input id="owner_dob" name="owner_dob" type="date" class="input-control" />
                      </div>
                      <div class="input-group">
                        <label for="owner_license">Licen√ßa / ID / SSN</label>
                        <input id="owner_license" name="owner_license" class="input-control" placeholder="Documento do cliente" />
                      </div>
                      <div class="input-group">
                        <label for="owner_street">Rua</label>
                        <input id="owner_street" name="owner_street" class="input-control" placeholder="Ex: 456 Oak Ave" />
                      </div>
                      <div class="input-group">
                        <label for="owner_city">Cidade</label>
                        <input id="owner_city" name="owner_city" class="input-control" placeholder="Ex: Miami" />
                      </div>
                      <div class="input-group">
                        <label for="owner_state">Estado</label>
                        <input id="owner_state" name="owner_state" maxlength="2" class="input-control" placeholder="Ex: FL" />
                      </div>
                      <div class="input-group">
                        <label for="owner_zipcode">CEP/ZIP</label>
                        <input id="owner_zipcode" name="owner_zipcode" class="input-control" placeholder="Ex: 33101" />
                      </div>
                    </div>
                  </section>

                  <section class="rta-section" aria-labelledby="rta-seller">
                    <div class="rta-section-header">
                      <div class="rta-section-icon" aria-hidden="true">üè™</div>
                      <div>
                        <h4 class="rta-section-title" id="rta-seller">Vendedor</h4>
                        <p class="rta-section-description">Informe os dados do vendedor exatamente como no formul√°rio legado.</p>
                      </div>
                    </div>
                    <div class="rta-grid rta-grid-wide">
                      <div class="input-group">
                        <label for="seller_name">Nome completo</label>
                        <input id="seller_name" name="seller_name" class="input-control" placeholder="Ex: Nome completo" />
                      </div>
                      <div class="input-group">
                        <label for="seller_street">Rua</label>
                        <input id="seller_street" name="seller_street" class="input-control" placeholder="Ex: 123 Main St" />
                      </div>
                      <div class="input-group">
                        <label for="seller_city">Cidade</label>
                        <input id="seller_city" name="seller_city" class="input-control" placeholder="Ex: Boston" />
                      </div>
                      <div class="input-group">
                        <label for="seller_state">Estado</label>
                        <input id="seller_state" name="seller_state" maxlength="2" class="input-control" placeholder="Ex: MA" />
                      </div>
                      <div class="input-group">
                        <label for="seller_zipcode">CEP/ZIP</label>
                        <input id="seller_zipcode" name="seller_zipcode" class="input-control" placeholder="Ex: 02101" />
                      </div>
                      <div class="input-group">
                        <label for="gross_sale_price">Pre√ßo bruto</label>
                        <input id="gross_sale_price" name="gross_sale_price" type="number" step="0.01" class="input-control" placeholder="Ex: 25000.00" />
                      </div>
                    </div>
                  </section>

                  <div class="rta-section">
                    <div class="rta-section-header">
                      <div class="rta-section-icon" aria-hidden="true">‚öôÔ∏è</div>
                      <div>
                        <h4 class="rta-section-title">A√ß√µes</h4>
                        <p class="rta-section-description">Gere o PDF e limpe o formul√°rio quando necess√°rio.</p>
                      </div>
                    </div>
                    <div class="rta-actions">
                      <button type="submit" class="btn-primary">Gerar PDF</button>
                      <button type="reset" class="btn-secondary">Limpar</button>
                      <span id="rtaStatus" class="rta-status-chip">Pronto</span>
                    </div>
                  </div>
                </form>
              
              <div id="rtaActions" class="hidden flex gap-2">
                <button id="rtaOpenBtn" class="btn-secondary">üìÑ Abrir PDF</button>
                <button id="rtaDownloadBtn" class="btn-secondary">üíæ Download novamente</button>
              </div>
              
              <pre id="rtaOutput" class="max-h-72 overflow-y-auto rounded-xl bg-slate-950/60 p-4 text-xs text-slate-300"></pre>
        </div>
      </div>
      </div>
    </div>

    <!-- Modal para editar/adicionar mensagem -->
    <div id="messageModal" class="modal-overlay hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle" class="text-xl font-semibold text-white">Adicionar mensagem</h3>
          <button id="closeModalBtn" class="text-slate-400 hover:text-white text-2xl leading-none">√ó</button>
        </div>
        
        <div class="modal-body">
          <div class="space-y-4">
            <div>
              <label for="messageText" class="block text-sm font-medium text-slate-300 mb-2">Texto da mensagem</label>
              <textarea 
                id="messageText" 
                rows="10" 
                class="w-full rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 focus:outline-none focus:ring-2 focus:ring-brand-500"
                placeholder="Digite a mensagem aqui..."
              ></textarea>
            </div>
            
            <div>
              <label for="messageImage" class="block text-sm font-medium text-slate-300 mb-2">Imagem (opcional)</label>
              <div class="flex gap-2">
                <input 
                  type="text" 
                  id="messageImage" 
                  class="flex-1 rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 focus:outline-none focus:ring-2 focus:ring-brand-500"
                  placeholder="Clique em 'Selecionar' ou cole o caminho completo"
                />
                <button 
                  type="button"
                  id="selectImageBtn" 
                  class="btn-secondary whitespace-nowrap"
                >
                  üìÅ Selecionar
                </button>
              </div>
              <p class="text-xs text-slate-400 mt-1">Deixe vazio para usar a imagem padr√£o do perfil</p>
            </div>
          </div>
        </div>
        
        <div class="modal-footer">
          <button id="cancelModalBtn" class="btn-secondary">Cancelar</button>
          <button id="saveMessageBtn" class="btn-primary">Salvar</button>
        </div>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
